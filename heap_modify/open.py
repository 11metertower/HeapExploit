pid = int(input("Input pid: "))

maps_addr = f"/proc/{pid}/maps"
mem_addr = f"/proc/{pid}/mem"

maps = open(maps_addr, "r")
mem = open(mem_addr, "rb+")

for line in maps:
    line = line.split(' ')
    if line[-1] == '[heap]\n':
        start_addr = int(line[0].split('-')[0], 16)
        end_addr = int(line[0].split('-')[1], 16)
        break

mem.seek(start_addr)
heap = mem.read(end_addr - start_addr)

index = heap.index(bytes("Tamy", "ASCII"))
print(index)

mem.seek(start_addr + index)
mem.write(bytes("Greg", "ASCII"))

maps.close()
mem.close()